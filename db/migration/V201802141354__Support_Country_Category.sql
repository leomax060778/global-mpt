CREATE COLUMN TABLE ALLOCATION_CATEGORY_TYPE(
	ALLOCATION_CATEGORY_TYPE_ID  BIGINT NOT NULL PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
	NAME NVARCHAR(255) NOT NULL,

	CREATED_DATE_TZ  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
	MODIFIED_DATE_TZ TIMESTAMP ,
	CREATED_USER_ID BIGINT NOT NULL,
	MODIFIED_USER_ID BIGINT NULL,
	ENABLED TINYINT NULL DEFAULT 1,
	DELETED TINYINT NULL DEFAULT 0
);

INSERT INTO ALLOCATION_CATEGORY_TYPE(ALLOCATION_CATEGORY_TYPE_ID, NAME, CREATED_USER_ID) VALUES (1, 'Country', 1);
INSERT INTO ALLOCATION_CATEGORY_TYPE(ALLOCATION_CATEGORY_TYPE_ID, NAME, CREATED_USER_ID) VALUES (2, 'Option', 1);

CREATE COLUMN TABLE ALLOCATION_COUNTRY_CATEGORY_OPTION(
	ALLOCATION_COUNTRY_CATEGORY_OPTION_ID  BIGINT NOT NULL PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
	NAME NVARCHAR(255) NOT NULL,
	CREATED_DATE_TZ  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
	MODIFIED_DATE_TZ TIMESTAMP ,
	CREATED_USER_ID BIGINT NOT NULL,
	MODIFIED_USER_ID BIGINT NULL,
	ENABLED TINYINT NULL DEFAULT 1,
	DELETED TINYINT NULL DEFAULT 0,
    DELETED_TOKEN NVARCHAR(255),
    CRM_KEY NVARCHAR(50)
);

ALTER TABLE ALLOCATION_CATEGORY ADD (CATEGORY_TYPE_ID BIGINT NOT NULL DEFAULT 2);
INSERT INTO ALLOCATION_CATEGORY (NAME, DESCRIPTION, CATEGORY_TYPE_ID, CREATED_USER_ID) VALUES ('Countries', 'Countries', 1, 1);

CREATE COLUMN TABLE ALLOCATION_COUNTRY_CATEGORY_OPTION_LEVEL(
    ALLOCATION_COUNTRY_CATEGORY_OPTION_LEVEL_ID  BIGINT NOT NULL PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    HIERARCHY_LEVEL_ID BIGINT NOT NULL,
    ALLOCATION_CATEGORY_ID BIGINT NOT NULL,
    ALLOCATION_COUNTRY_CATEGORY_OPTION_ID BIGINT NOT NULL,
    MAKE_CATEGORY_MANDATORY TINYINT NOT NULL DEFAULT 0,
    IN_PROCESSING_REPORT TINYINT NOT NULL DEFAULT 0,
	CREATED_DATE_TZ  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
	MODIFIED_DATE_TZ TIMESTAMP ,
	CREATED_USER_ID BIGINT NOT NULL,
	MODIFIED_USER_ID BIGINT NULL,
	ENABLED TINYINT NULL DEFAULT 1,
	DELETED TINYINT NULL DEFAULT 0
);

CREATE COLUMN TABLE ALLOCATION_COUNTRY_CATEGORY_OPTION_LEVEL_HL2(
    ALLOCATION_COUNTRY_CATEGORY_OPTION_LEVEL_HL2_ID  BIGINT NOT NULL PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    ALLOCATION_COUNTRY_CATEGORY_OPTION_LEVEL_ID  BIGINT NOT NULL,
    HL2_ID BIGINT NOT NULL,
	CREATED_DATE_TZ  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
	MODIFIED_DATE_TZ TIMESTAMP ,
	CREATED_USER_ID BIGINT NOT NULL,
	MODIFIED_USER_ID BIGINT NULL,
	ENABLED TINYINT NULL DEFAULT 1,
	DELETED TINYINT NULL DEFAULT 0
);

CREATE COLUMN TABLE HL5_COUNTRY_CATEGORY_OPTION(
    HL5_COUNTRY_CATEGORY_OPTION_ID  BIGINT NOT NULL PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    HL5_ID BIGINT NOT NULL,
    ALLOCATION_COUNTRY_CATEGORY_OPTION_LEVEL_ID BIGINT NOT NULL,
    UPDATED TINYINT NOT NULL,
    AMOUNT DECIMAL(19,2) NOT NULL,
	CREATED_DATE_TZ  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
	MODIFIED_DATE_TZ TIMESTAMP ,
	CREATED_USER_ID BIGINT NOT NULL,
	MODIFIED_USER_ID BIGINT NULL,
	ENABLED TINYINT NULL DEFAULT 1,
	DELETED TINYINT NULL DEFAULT 0
);

CREATE COLUMN TABLE HL6_COUNTRY_CATEGORY_OPTION(
    HL6_COUNTRY_CATEGORY_OPTION_ID  BIGINT NOT NULL PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    HL6_ID BIGINT NOT NULL,
    ALLOCATION_COUNTRY_CATEGORY_OPTION_LEVEL_ID BIGINT NOT NULL,
    UPDATED TINYINT NOT NULL,
    AMOUNT DECIMAL(19,2) NOT NULL,
	CREATED_DATE_TZ  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
	MODIFIED_DATE_TZ TIMESTAMP ,
	CREATED_USER_ID BIGINT NOT NULL,
	MODIFIED_USER_ID BIGINT NULL,
	ENABLED TINYINT NULL DEFAULT 1,
	DELETED TINYINT NULL DEFAULT 0
);

-- *************************************************************************************
-- Update schema version
INSERT INTO SCHEMA_VERSION(VERSION, DESCRIPTION, SCRIPT)
VALUES('V5.0.0-123', 'Add Support Country Category', 'V201802141354__Support_Country_Category.sql');

COMMIT;