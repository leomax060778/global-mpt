-- ********************* PLANNING_PURPOSE ********************* --
CREATE COLUMN TABLE "MKTG_PLANNING_TOOL"."PLANNING_PURPOSE"(
	PLANNING_PURPOSE_ID BIGINT NOT NULL PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
	NAME NVARCHAR(255),
	TEAM_TYPE_ID BIGINT NOT NULL,
    ENABLED TINYINT DEFAULT 1,
    DELETED TINYINT DEFAULT 0,

	CREATED_USER_ID BIGINT,
	CREATED_DATE_TZ TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
	MODIFIED_USER_ID BIGINT,
	MODIFIED_DATE_TZ TIMESTAMP

);

ALTER TABLE "MKTG_PLANNING_TOOL"."PLANNING_PURPOSE" ADD FOREIGN KEY ( "CREATED_USER_ID" ) REFERENCES "MKTG_PLANNING_TOOL"."USER" ("USER_ID") ON UPDATE RESTRICT ON DELETE RESTRICT;
ALTER TABLE "MKTG_PLANNING_TOOL"."PLANNING_PURPOSE" ADD FOREIGN KEY ( "TEAM_TYPE_ID" ) REFERENCES "MKTG_PLANNING_TOOL"."TEAM_TYPE" ("TEAM_TYPE_ID") ON UPDATE RESTRICT ON DELETE RESTRICT;

CREATE COLUMN TABLE "MKTG_PLANNING_TOOL"."PLANNING_PURPOSE_OPTION"(
	PLANNING_PURPOSE_OPTION_ID BIGINT NOT NULL PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
	NAME NVARCHAR(255),
	PLANNING_PURPOSE_ID BIGINT,
    ENABLED TINYINT DEFAULT 1,
    DELETED TINYINT DEFAULT 0,

	CREATED_USER_ID BIGINT,
	CREATED_DATE_TZ TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
	MODIFIED_USER_ID BIGINT,
	MODIFIED_DATE_TZ TIMESTAMP

);

ALTER TABLE "MKTG_PLANNING_TOOL"."PLANNING_PURPOSE_OPTION" ADD FOREIGN KEY ( "CREATED_USER_ID" ) REFERENCES "MKTG_PLANNING_TOOL"."USER" ("USER_ID") ON UPDATE RESTRICT ON DELETE RESTRICT;
ALTER TABLE "MKTG_PLANNING_TOOL"."PLANNING_PURPOSE_OPTION" ADD FOREIGN KEY ( "PLANNING_PURPOSE_ID" ) REFERENCES "MKTG_PLANNING_TOOL"."PLANNING_PURPOSE" ("PLANNING_PURPOSE_ID") ON UPDATE RESTRICT ON DELETE RESTRICT;

INSERT INTO "MKTG_PLANNING_TOOL"."PLANNING_PURPOSE"(
    PLANNING_PURPOSE_ID,
	NAME,
	TEAM_TYPE_ID,
	CREATED_USER_ID
)
VALUES(
    1,
	'Regional Marketing',
	1,
	1
);

INSERT INTO "MKTG_PLANNING_TOOL"."PLANNING_PURPOSE"(
    PLANNING_PURPOSE_ID,
	NAME,
	TEAM_TYPE_ID,
	CREATED_USER_ID
)
VALUES(
    2,
	'Product Marketing',
	2,
	1
);

INSERT INTO "MKTG_PLANNING_TOOL"."PLANNING_PURPOSE"(
    PLANNING_PURPOSE_ID,
	NAME,
	TEAM_TYPE_ID,
	CREATED_USER_ID
)
VALUES(
    3,
	'Functional Teams',
	2,
	1
);

INSERT INTO "MKTG_PLANNING_TOOL"."PLANNING_PURPOSE"(
    PLANNING_PURPOSE_ID,
	NAME,
	TEAM_TYPE_ID,
	CREATED_USER_ID
)
VALUES(
    4,
	'Communications',
	2,
	1
);

INSERT INTO "MKTG_PLANNING_TOOL"."PLANNING_PURPOSE"(
    PLANNING_PURPOSE_ID,
	NAME,
	TEAM_TYPE_ID,
	CREATED_USER_ID
)
VALUES(
    5,
	'Business Services, Strategy and Culture',
	2,
	1
);

INSERT INTO "MKTG_PLANNING_TOOL"."PLANNING_PURPOSE_OPTION"(NAME,PLANNING_PURPOSE_ID,CREATED_USER_ID) VALUES ('Audience Programs & Campaigns',3,1);
INSERT INTO "MKTG_PLANNING_TOOL"."PLANNING_PURPOSE_OPTION"(NAME,PLANNING_PURPOSE_ID,CREATED_USER_ID) VALUES ('Brand Experience',3,1);
INSERT INTO "MKTG_PLANNING_TOOL"."PLANNING_PURPOSE_OPTION"(NAME,PLANNING_PURPOSE_ID,CREATED_USER_ID) VALUES ('Content Marketing',3,1);
INSERT INTO "MKTG_PLANNING_TOOL"."PLANNING_PURPOSE_OPTION"(NAME,PLANNING_PURPOSE_ID,CREATED_USER_ID) VALUES ('Customer Experience',3,1);
INSERT INTO "MKTG_PLANNING_TOOL"."PLANNING_PURPOSE_OPTION"(NAME,PLANNING_PURPOSE_ID,CREATED_USER_ID) VALUES ('Events',3,1);
INSERT INTO "MKTG_PLANNING_TOOL"."PLANNING_PURPOSE_OPTION"(NAME,PLANNING_PURPOSE_ID,CREATED_USER_ID) VALUES ('General Business',3,1);
INSERT INTO "MKTG_PLANNING_TOOL"."PLANNING_PURPOSE_OPTION"(NAME,PLANNING_PURPOSE_ID,CREATED_USER_ID) VALUES ('SAP Leonardo',3,1);
INSERT INTO "MKTG_PLANNING_TOOL"."PLANNING_PURPOSE_OPTION"(NAME,PLANNING_PURPOSE_ID,CREATED_USER_ID) VALUES ('Strategic Partnerships and oCMO',3,1);
INSERT INTO "MKTG_PLANNING_TOOL"."PLANNING_PURPOSE_OPTION"(NAME,PLANNING_PURPOSE_ID,CREATED_USER_ID) VALUES ('Administrative Use Only',3,1);
INSERT INTO "MKTG_PLANNING_TOOL"."PLANNING_PURPOSE_OPTION"(NAME,PLANNING_PURPOSE_ID,CREATED_USER_ID) VALUES ('Sponsorships & EBCs',3,1);
INSERT INTO "MKTG_PLANNING_TOOL"."PLANNING_PURPOSE_OPTION"(NAME,PLANNING_PURPOSE_ID,CREATED_USER_ID) VALUES ('Strategy & Thought Leadership',3,1);
INSERT INTO "MKTG_PLANNING_TOOL"."PLANNING_PURPOSE_OPTION"(NAME,PLANNING_PURPOSE_ID,CREATED_USER_ID) VALUES ('University Alliances & Next Gen',3,1);


ALTER TABLE "MKTG_PLANNING_TOOL"."HL1" ADD(PLANNING_PURPOSE_ID BIGINT NULL);
ALTER TABLE "MKTG_PLANNING_TOOL"."HL1_VERSION" ADD(PLANNING_PURPOSE_ID BIGINT NULL);

ALTER TABLE "MKTG_PLANNING_TOOL"."HL2" ADD(PLANNING_PURPOSE_OPTION_ID BIGINT NULL);
ALTER TABLE "MKTG_PLANNING_TOOL"."HL2_VERSION" ADD(PLANNING_PURPOSE_OPTION_ID BIGINT NULL);

UPDATE TEAM_TYPE SET NAME = 'Global' WHERE TEAM_TYPE_ID = 2;

-- *************************************************************************************
-- Update schema version
INSERT INTO SCHEMA_VERSION(VERSION, DESCRIPTION, SCRIPT)
VALUES('V5.0.0-167', 'Create planning purpose and Planning Purpose Relation', 'V201808161445__Create_Planning_Purpose.sql');

COMMIT;
