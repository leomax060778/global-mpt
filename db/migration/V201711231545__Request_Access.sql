
CREATE COLUMN TABLE "MKTG_PLANNING_TOOL"."REQUEST_ACCESS_STATUS" (
    "REQUEST_ACCESS_STATUS_ID" bigint not null primary key generated by default as IDENTITY,
    "NAME" NVARCHAR(50) NOT NULL,
    "DISPLAY_NAME" NVARCHAR(50) NOT NULL,
    "CREATED_DATE_TZ" timestamp default CURRENT_TIMESTAMP,
    "MODIFIED_DATE_TZ" timestamp,
    "CREATED_USER_ID" bigint not null,
    "MODIFIED_USER_ID" bigint,
    "ENABLED" tinyint default 1,
    "DELETED" tinyint default 0,
    FOREIGN KEY ("CREATED_USER_ID") REFERENCES "MKTG_PLANNING_TOOL"."USER"("USER_ID")
);
INSERT INTO "MKTG_PLANNING_TOOL"."REQUEST_ACCESS_STATUS"(REQUEST_ACCESS_STATUS_ID, NAME, DISPLAY_NAME, CREATED_USER_ID)VALUES(1, 'PENDING', 'Pending', 1);
INSERT INTO "MKTG_PLANNING_TOOL"."REQUEST_ACCESS_STATUS"(REQUEST_ACCESS_STATUS_ID, NAME, DISPLAY_NAME, CREATED_USER_ID)VALUES(2, 'REJECTED', 'Rejected', 1);
INSERT INTO "MKTG_PLANNING_TOOL"."REQUEST_ACCESS_STATUS"(REQUEST_ACCESS_STATUS_ID, NAME, DISPLAY_NAME, CREATED_USER_ID)VALUES(3, 'APPROVED', 'Approved', 1);

CREATE COLUMN TABLE "MKTG_PLANNING_TOOL"."REQUEST_ACCESS" (
	"REQUEST_ACCESS_ID" bigint not null primary key generated by default as IDENTITY,
	 "USER_NAME" NVARCHAR(255) NOT NULL ,
	 "FIRST_NAME" NVARCHAR(255) NOT NULL ,
	 "LAST_NAME" NVARCHAR(255) NOT NULL ,
	 "EMAIL" NVARCHAR(255) NOT NULL ,
	 "PHONE" NVARCHAR(255),
	 "REQUEST_ACCESS_STATUS_ID" BIGINT NOT NULL,
	 "CREATED_DATE_TZ" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
	 "MODIFIED_DATE_TZ" TIMESTAMP,
	 "CREATED_USER_ID" BIGINT NOT NULL ,
	 "MODIFIED_USER_ID" BIGINT,
	 "ENABLED" TINYINT DEFAULT 1,
	 "DELETED" TINYINT DEFAULT 0,
	 FOREIGN KEY ("CREATED_USER_ID") REFERENCES "MKTG_PLANNING_TOOL"."USER"("USER_ID"),
	 FOREIGN KEY ("REQUEST_ACCESS_STATUS_ID") REFERENCES "MKTG_PLANNING_TOOL"."REQUEST_ACCESS_STATUS"("REQUEST_ACCESS_STATUS_ID")
);

UPDATE CONFIGURATION SET VALUE = 'eddie.rivas01@sap.com' WHERE KEY = 'SiteAdministrator';

-- *************************************************************************************
-- Update schema version
INSERT INTO SCHEMA_VERSION(VERSION, DESCRIPTION, SCRIPT)
VALUES('V5.0.0-91', 'Request Access', 'V201711231545__Request_Access.sql');

COMMIT;