-----------------------------------------------------------------
--Check CSD username and password before running this migration--
-----------------------------------------------------------------
INSERT INTO "MKTG_PLANNING_TOOL"."CONFIGURATION"(KEY,VALUE,DESCRIPTION,CREATED_USER_ID) VALUES('CsdUser','mtpuser','CSD username',1);
INSERT INTO "MKTG_PLANNING_TOOL"."CONFIGURATION"(KEY,VALUE,DESCRIPTION,CREATED_USER_ID) VALUES('CsdPassword','mtpuser1#','CSD password',1);

CREATE COLUMN TABLE SERVICE_REQUEST_FORM_TYPE (
    SERVICE_REQUEST_FORM_TYPE_ID  BIGINT NOT NULL PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    NAME NVARCHAR(255) NOT NULL,
    DISPLAY_NAME NVARCHAR(255) NOT NULL,
    AUTOMATIC_APPROVAL TINYINT DEFAULT 0,
    DELETED_TOKEN NVARCHAR(255),
    CREATED_DATE_TZ  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    MODIFIED_DATE_TZ TIMESTAMP ,
    CREATED_USER_ID BIGINT NOT NULL,
    MODIFIED_USER_ID BIGINT NULL,
    ENABLED TINYINT NULL DEFAULT 1,
    DELETED TINYINT NULL DEFAULT 0
);

INSERT INTO SERVICE_REQUEST_FORM_TYPE (NAME,DISPLAY_NAME,CREATED_USER_ID) VALUES ('LEAD','Lead Upload/Lead & Opportunity Update',1);
INSERT INTO SERVICE_REQUEST_FORM_TYPE (NAME,DISPLAY_NAME,CREATED_USER_ID) VALUES ('ACTIVITIES','Uploading/Updating Activities',1);
INSERT INTO SERVICE_REQUEST_FORM_TYPE (NAME,DISPLAY_NAME,CREATED_USER_ID) VALUES ('SEGMENTATION','Target Select Segmentation',1);

ALTER TABLE SERVICE_REQUEST_OPTION ADD (SERVICE_REQUEST_FORM_TYPE_ID BIGINT);

UPDATE SERVICE_REQUEST_OPTION SET
SERVICE_REQUEST_FORM_TYPE_ID = (SELECT SERVICE_REQUEST_FORM_TYPE_ID FROM SERVICE_REQUEST_FORM_TYPE WHERE NAME = 'SEGMENTATION')
WHERE NAME LIKE '%Segmentation%';

-- *************************************************************************************
-- Update schema version
INSERT INTO SCHEMA_VERSION(VERSION, DESCRIPTION, SCRIPT)
VALUES('V5.0.0-163', 'Support CSD issue types', 'V2001807110850__Support_CSD_Issue_Types.sql');

COMMIT;

